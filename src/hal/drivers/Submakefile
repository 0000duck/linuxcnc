hal/drivers/pluto_servo_rbf.h: hal/drivers/pluto_servo_firmware/pluto_servo.rbf hal/drivers/rbf2h.py
	python hal/drivers/rbf2h.py -g \
    -c "This is a component of pluto_servo, a PWM servo driver and" \
    -c "quadrature counter for emc2" \
    -c "Copyright (C) 2006, 2007 Jeff Epler" \
	    $< > $@

hal/drivers/pluto_step_rbf.h: hal/drivers/pluto_step_firmware/pluto_step.rbf hal/drivers/rbf2h.py
	python hal/drivers/rbf2h.py -g \
    -c "This is a component of pluto_step, a hardware step generator for emc2" \
    -c "Copyright (C) 2006, 2007 Jeff Epler" \
	    $< > $@

hal/drivers/m5i20_HM5-4E.h: hal/drivers/m5i20/bit/hostmot5_4.bit ../bin/m5i20cfg
	../bin/m5i20cfg $< > $@


hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-4.h: hal/drivers/mesa7i43-firmware/gpio/eppio8-4.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of mesa7i43-gpio, a GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-2.h: hal/drivers/mesa7i43-firmware/gpio/eppio8-2.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of mesa7i43-gpio, a GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4b.h: hal/drivers/mesa7i43-firmware/hostmot2/svst4_4b.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of m7i43-hm2, a Servo/Stepper/GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007-2008, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4s.h: hal/drivers/mesa7i43-firmware/hostmot2/svst4_4s.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of m7i43-hm2, a Servo/Stepper/GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007-2008, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8b.h: hal/drivers/mesa7i43-firmware/hostmot2/sv8b.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of m7i43-hm2, a Servo/Stepper/GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007-2008, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8s.h: hal/drivers/mesa7i43-firmware/hostmot2/sv8s.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of m7i43-hm2, a Servo/Stepper/GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007-2008, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@

hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_6b.h: hal/drivers/mesa7i43-firmware/hostmot2/svst4_6b.bit hal/drivers/mesa7i43-firmware/to-header.py
	python hal/drivers/mesa7i43-firmware/to-header.py                 \
	-d                                                                \
	-c "This is a component of m7i43-hm2, a Servo/Stepper/GPIO driver for EMC2" \
	-c ""                                                             \
	-c "Copyright (C) 2007-2008, Peter C. Wallace, Mesa Electronics"       \
	-c "<http://www.mesanet.com>"                                     \
	$< > $@


clean: pluto_clean m7i43_clean
pluto_clean:
	rm  -rf \
	    pluto_servo_firmware/db \
	    pluto_servo_firmware/pluto_servo.asm.rpt \
	    pluto_servo_firmware/pluto_servo.done \
	    pluto_servo_firmware/pluto_servo.fit.rpt \
	    pluto_servo_firmware/pluto_servo.fit.summary \
	    pluto_servo_firmware/pluto_servo.flow.rpt \
	    pluto_servo_firmware/pluto_servo.map.rpt \
	    pluto_servo_firmware/pluto_servo.map.summary \
	    pluto_servo_firmware/pluto_servo.pin \
	    pluto_servo_firmware/pluto_servo.pof \
	    pluto_servo_firmware/pluto_servo.qws \
	    pluto_servo_firmware/pluto_servo.rbf \
	    pluto_servo_firmware/pluto_servo.sof \
	    pluto_servo_firmware/pluto_servo.tan.rpt \
	    pluto_servo_firmware/pluto_servo.tan.summary \
	    pluto_servo_firmware/undo_redo.txt

m7i43_clean:
	rm  -f \
	hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-4.h   \
	hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-2.h   \
	hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4b.h  \
	hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4s.h  \
	hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8b.h      \
	hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8s.h      \
	hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_6b.h

# The kernel's build system won't know how to rebuild generated files
# so modules must depend on them explicitly
ifneq ($(BUILD_SYS),sim)
modules:                                                         \
    hal/drivers/pluto_servo_rbf.h                                \
    hal/drivers/m5i20_HM5-4E.h                                   \
    hal/drivers/pluto_step_rbf.h                                 \
    hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-4.h   \
    hal/drivers/mesa7i43-firmware/mesa7i43-firmware-eppio8-2.h   \
    hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4b.h  \
    hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_4s.h  \
    hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8b.h      \
    hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-sv8s.h      \
    hal/drivers/mesa7i43-firmware/m7i43-firmware-hm2-svst4_6b.h
endif


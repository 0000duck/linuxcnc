#!/bin/bash

PATH=@EMC2_BIN_DIR@:$PATH
REALTIME=@REALTIME@

if $REALTIME status > /dev/null; then
    echo "Realtime already running"
    exit 1
fi

if [ $# -eq 0 ]; then set -- -kf; fi

case $1 in
*.hal) set -- -f $1
esac

$REALTIME start

halcmd $@; result=$?

halcmd unload all || result=$?

$REALTIME stop || result=$?

exit $result
